<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Denúncias - MiniTwitter</title>
<style>
  body { font-family: Arial, sans-serif; background:#e6ecf0; margin:0; padding:0; }
  header { background:#1da1f2; color:white; padding:15px; font-size:24px; text-align:center; font-weight:bold; }
  .container { max-width:600px; margin:30px auto; background:white; padding:20px; border-radius:10px; box-shadow:0 0 10px rgba(0,0,0,0.1); }
  .user { border-bottom:1px solid #ccc; padding:10px 0; display:flex; align-items:center; justify-content:space-between; }
  .user-info { display:flex; align-items:center; }
  .user-info img { width:50px; height:50px; border-radius:50%; margin-right:10px; }
  button { background:red; color:white; border:none; border-radius:5px; padding:5px 10px; cursor:pointer; }
  button:hover { background:darkred; }
  .banned { opacity:0.5; text-decoration:line-through; }
</style>
<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
</head>
<body>

<header>Denúncias de Usuários</header>

<div class="container" id="users-container"></div>

<script>
  // Configuração Firebase - substitua pelos valores do seu projeto
  const firebaseConfig = {
    apiKey: "SUA_API_KEY",
    authDomain: "SEU_PROJECT_ID.firebaseapp.com",
    projectId: "SEU_PROJECT_ID",
    storageBucket: "SEU_PROJECT_ID.appspot.com",
    messagingSenderId: "SENDER_ID",
    appId: "APP_ID"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  let currentUser = localStorage.getItem("currentUser");
  if(!currentUser){
    alert("Nenhum usuário logado! Redirecionando...");
    window.location.href = "index.html";
  }

  const container = document.getElementById("users-container");

  // Carrega usuários em tempo real
  db.collection("users").onSnapshot(snapshot => {
    container.innerHTML = "";
    snapshot.forEach(doc => {
      const user = doc.data();
      const div = document.createElement("div");
      div.className = "user" + (user.banned ? " banned" : "");
      div.innerHTML = `
        <div class="user-info">
          <img src="${user.avatar}" alt="Avatar">
          <div>
            <strong>${user.name}</strong><br>
            <span>${user.bio || ""}</span><br>
            <small>Denúncias: ${user.reports || 0}</small>
          </div>
        </div>
        <div>
          ${user.name !== currentUser && !user.banned ? `<button onclick="reportUser('${user.name}')">Denunciar</button>` : ""}
        </div>
      `;
      container.appendChild(div);
    });
  });

  async function reportUser(username){
    if(!confirm("Deseja realmente denunciar este usuário?")) return;
    const userRef = db.collection("users").doc(username);
    const userDoc = await userRef.get();
    if(!userDoc.exists) return;

    const data = userDoc.data();
    const newReports = (data.reports || 0) + 1;
    const updates = { reports: newReports };
    if(newReports >= 3) updates.banned = true;
    await userRef.update(updates);

    alert("Usuário denunciado com sucesso!");
  }
</script>

</body>
</html>
